#
# CIP Core, generic profile
#
# Copyright (c) Siemens AG, 2019-2025
#
# Authors:
#  Jan Kiszka <jan.kiszka@siemens.com>
#
# SPDX-License-Identifier: MIT
#

header:
  version: 14

distro: cip-core-bookworm
target: cip-core-image

build_system: isar

repos:
  cip-core:

  isar:
    url: https://github.com/ilbers/isar.git
    commit: 8e3122249a52db470efb32b92ed9c44e4b758712
    patches:
      00-archived-buster:
        repo: cip-core
        path: isar-patches/0001-Pull-buster-from-archive.d.o.patch
    layers:
      meta:

bblayers_conf_header:
  standard: |
    LCONF_VERSION = "6"

local_conf_header:
  standard: |
    CONF_VERSION = "1"
  cross: |
    ISAR_CROSS_COMPILE = "1"
  ccache: |
    USE_CCACHE = "1"
  root_password: |
    USERS += "root"
    USER_root[password] = "root"
    USER_root[flags] = "clear-text-password"
  source_epoch: |
    SOURCE_DATE_EPOCH_FALLBACK := "${@bb.process.run("git -C ${LAYERDIR_cip-core} log -1 --pretty=%ct | tr -d '\n'")[0]}"

env:
  DISTRO_APT_PREMIRRORS: ""
