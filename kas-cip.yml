#
# CIP Core, generic profile
#
# Copyright (c) Siemens AG, 2019-2024
#
# Authors:
#  Jan Kiszka <jan.kiszka@siemens.com>
#
# SPDX-License-Identifier: MIT
#

header:
  version: 14

distro: cip-core-bookworm
target: cip-core-image

build_system: isar

defaults:
  repos:
    patches:
      repo: cip-core

repos:
  cip-core:

  isar:
    url: https://github.com/ilbers/isar.git
    commit: 604e662c707cb79235a473bff36a8b4cc5c6b2c0
    layers:
      meta:
    patches:
      p1:
        path: patches/0001-image.bbclass-use-oe.utils.directory_size-instead-of.patch
      p2:
        path: patches/0002-Print-ROOTFS_SIZE-for-debugging.patch

bblayers_conf_header:
  standard: |
    LCONF_VERSION = "6"

local_conf_header:
  standard: |
    CONF_VERSION = "1"
  cross: |
    ISAR_CROSS_COMPILE = "1"
  ccache: |
    USE_CCACHE = "1"
  root_password: |
    USERS += "root"
    USER_root[password] = "root"
    USER_root[flags] = "clear-text-password"
  source_epoch: |
    SOURCE_DATE_EPOCH_FALLBACK := "${@bb.process.run("git -C ${LAYERDIR_cip-core} log -1 --pretty=%ct | tr -d '\n'")[0]}"

env:
  DISTRO_APT_PREMIRRORS: ""
